
{% load static %}

{% block content %}
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
  <script src="{% static 'js/dashboard.js' %}" defer></script>
</head>

  <header>
      <img src="{% static 'images/logo.png' %}" alt="Logo">
      <nav>
        <a href="{% url 'dashboard' %}">Home</a>
        <a href="{% url 'fridgeAi' %}">Fridge</a>
        <a href="#">Settings</a>
        <a href="{% url 'logout' %}">Logout</a>
      </nav>
  </header>

<body>
  <main>
    {% if customer %}
      <h2>Welcome, {{ customer.user.first_name }}!</h2>
      <p>Calorie Goal: {{ customer.daily_calories }}</p>

      <div class="date-nav">
        <button id="prevDay" class="date-btn">←</button>
        <span id="selectedDate"></span>
        <button id="nextDay" class="date-btn">→</button>
      </div>



      <div class="dashboard-container">
        <!-- --- MACRO & CALORIE PROGRESS SECTION --- -->
        <div class="macro-section">

          <!-- CALORIES -->
          <div class="macro-progress">
            <h3>Calories</h3>
            <div class="progress-bar">
              <div id="calorieProgress" class="progress-fill calorie-fill"></div>
            </div>
            <p>
              <span id="eatenCalories">0</span> kcal eaten 
              <span id="remainingCalories">0</span> kcal remaining
            </p>
          </div>

          <!-- PROTEIN -->
          <div class="macro-progress">
            <h3>Protein</h3>
            <div class="progress-bar">
              <div id="proteinBar" class="progress-fill protein-fill"></div>
            </div>
            <p>
              <span id="proteinEaten">0</span>g eaten 
              <span id="proteinRemaining">0</span>g remaining
            </p>
          </div>

          <!-- CARBS -->
          <div class="macro-progress">
            <h3>Carbs</h3>
            <div class="progress-bar">
              <div id="carbBar" class="progress-fill carb-fill"></div>
            </div>
            <p>
              <span id="carbsEaten">0</span>g eaten 
              <span id="carbsRemaining">0</span>g remaining
            </p>
          </div>

          <!-- FATS -->
          <div class="macro-progress">
            <h3>Fats</h3>
            <div class="progress-bar">
              <div id="fatBar" class="progress-fill fat-fill"></div>
            </div>
            <p>
              <span id="fatsEaten">0</span>g eaten 
              <span id="fatsRemaining">0</span>g remaining
            </p>
          </div>

        </div>

        <!-- CENTER: MEALS LIST -->
        <div class="meals-card">
          <div class="meals-header">
            <h3>Meals for this Day</h3>
            <button id="openAddModal" class="btn-submit">+ Add Meal</button>
          </div>

          <ul id="mealsContainer" class="meals-list"></ul>
        </div>
      
        <!-- Meal Modal -->
        <div id="mealModal" class="modal hidden">
          <div class="modal-content">
            <h3 id="modalTitle">Add Meal</h3>

            <form id="mealForm">
              {% csrf_token %}
              <input type="hidden" id="mealId">

              <label>Meal Type</label>
              <select id="mealType" required>
                <option value="">Select</option>
                <option value="breakfast">Breakfast</option>
                <option value="lunch">Lunch</option>
                <option value="dinner">Dinner</option>
                <option value="snack">Snack</option>
              </select>

              <label>Name</label>
              <input type="text" id="mealName" required>

              <label>Calories</label>
              <input type="number" id="mealCalories" required>

              <label>Protein (g)</label>
              <input type="number" id="mealProtein" required>

              <label>Carbs (g)</label>
              <input type="number" id="mealCarbs" required>

              <label>Fats (g)</label>
              <input type="number" id="mealFats" required>

              <div class="modal-actions">
                <button type="submit" class="btn-submit">Save</button>
                <button type="button" id="closeModal" class="btn-cancel">Cancel</button>
              </div>
            </form>
          </div>
        </div>

      </div>

    {% else %}
      <p>No profile found for this user.</p>
    {% endif %}
  </main>  
</body>
{% endblock %}
